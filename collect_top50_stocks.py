import yfinance as yf
import pandas as pd

# 코스피 상위 50종목 리스트
stocks = {
    '삼성전자': '005930.KS',
    'SK하이닉스': '000660.KS',
    'LG에너지솔루션': '373220.KS',
    'NAVER': '035420.KS',
    '카카오': '035720.KS',
    '삼성바이오로직스': '207940.KS',
    '현대차': '005380.KS',
    '기아': '000270.KS',
    '신한지주': '055550.KS',
    'KB금융': '105560.KS',
    'LG화학': '051910.KS',
    '삼성SDI': '006400.KS',
    'SK텔레콤': '017670.KS',
    '포스코': '005490.KS',
    '하이닉스': '000660.KS',
    'LG전자': '066570.KS',
    '대한항공': '003490.KS',
    '셀트리온': '068270.KS',
    '우리금융': '316140.KS',
    '한화솔루션': '009830.KS',
    '삼성생명': '032830.KS',
    '두산중공업': '034020.KS',
    '셀트리온헬스케어': '091990.KS',
    '오리온': '271560.KS',
    'LG디스플레이': '034220.KS',
    '아모레퍼시픽': '090430.KS',
    '에스디바이오센서': '137310.KS',
    '한미약품': '128940.KS',
    '롯데케미칼': '011170.KS',
    'CJ제일제당': '097950.KS',
    '증권사': '004940.KS',
    'GS건설': '006360.KS',
    '삼성물산': '028260.KS',
    '대우건설': '047040.KS',
    'LG상사': '001120.KS',
    '하나금융지주': '086790.KS',
    'S-Oil': '010950.KS'
}

# 최근 6개월의 일봉 OHLCV 데이터 수집
for company, code in stocks.items():
    try:
        df = yf.download(code, period='6mo')
        df['종목코드'] = code
        df.reset_index(inplace=True)
        print(f'{company} 데이터 수집 완료')
        # 여기에 Supabase에 데이터 저장 로직 추가
    except Exception as e:
        print(f'{company} 데이터 수집 오류: {e}')